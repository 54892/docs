---
title: 'Send data from AWS to Axiom using AWS Distro for OpenTelemetry'
description: 'This guide explains how to auto-instrument AWS Lambda functions and send telemetry data to Axiom using AWS Distro for OpenTelemetry.'
sidebarTitle: AWS DOT
---

In this guide, we explore how to use OpenTelemetry to auto-instrument and monitor applications running on AWS Lambda using the OpenTelemetry collector layer optimized for AWS, named AWS Distro for OpenTelemetry(ADOT).

We look at configuring the ADOT as the Lambda layer for the Python runtime.

## What is the AWS ADOT Lambda collector layer?

[ADOT Lambda layers](https://aws-otel.github.io/docs/getting-started/lambda) provides a plug-and-play user experience by automatically instrumenting a Lambda function, by packaging OpenTelemetry together with an out-of-the-box configuration for AWS Lambda and OTLP in an easy to setup layer. Users can enable and disable OpenTelemetry for their Lambda function without changing code.

With the ADOT collector layer you can send telemetry data to Axiom with a simple configuration.

## Prerequisites

What do you need to follow this guide successfully?

- Axiom dataset and API key with ingest permission
- Lambda function to apply configuration to


## Setup ADOT Lambda layer

In this guide we are going to create a new Lambda function and apply the ADOT Lambda layer to it with the proper configuration.

**1: Create the Lambda function**

You can deploy your Lambda function with the choice of your runtime. In this example, we're going to use Python3.10 as our runtime.

```python
import json

print('Loading function')


def lambda_handler(event, context):
    #print("Received event: " + json.dumps(event, indent=2))
    print("value1 = " + event['key1'])
    print("value2 = " + event['key2'])
    print("value3 = " + event['key3'])
    return event['key1']  # Echo back the first key value
    #raise Exception('Something went wrong')
```

**2: Add the ADOT lambda layer**

To add the ADOT Lambda layer to your function, you can use the AWS console to add a new layer with the following ARN:

```bash
arn:aws:lambda:eu-west-1:901920570463:layer:aws-otel-python-amd64-ver-1-25-0:1
```

note: the ARN is going to differ based on the region you are deploying your Lambda function to, and the version of the ADOT Lambda layer you are using. You can check the latest version of the layer in the [ADOT Lambda layer documentation for Python](Enable auto-instrumentation for your Lambda function
).


**3: Enable auto-instrumentation for your Lambda function**

We need to wrap the function handler with the OpenTelemetry Lambda wrapper, which is a thin layer that initializes the OpenTelemetry agent and handles the lifecycle of spans. The wrapper is located in `/opt/otel-instrument`, as stated in the [official ADOT documentation](Enable auto-instrumentation for your Lambda function). To acheive that we need to set the required environment variables like this:

```bash
AWS_LAMBDA_EXEC_WRAPPER: /opt/otel-instrument
```


**4: Create the collector configuration file**

Before we continue, we need to create a configuration file for the ADOT collector. The configuration file is a YAML file that contains the configuration for the OpenTelemetry collector. The file will live inside the function and we need to tell the collector where to find it, by setting another environment variable called `OPENTELEMETRY_COLLECTOR_CONFIG_FILE`, assuming the filename will be `collector.yaml` and lives in the root folder of the function, the value will look like this

```bash
OPENTELEMETRY_COLLECTOR_CONFIG_FILE: /var/task/collector.yaml
```

Now create the configuration file and add the following content:

```yaml
receivers:
  otlp:
    protocols:
      grpc:
      http:

exporters:
  otlphttp:
    compression: gzip
    endpoint: https://api.axiom.co
    headers:
      authorization: Bearer <axiom-api-token-here>
      x-axiom-dataset: <axiom-dataset-name-here>

service:
  pipelines:
    logs:
      receivers: [otlp]
      exporters: [otlphttp]
    traces:
      receivers: [otlp]
      exporters: [otlphttp]
```

This tells the collector to receive telemetry data from the OTLP receiver and export it to Axiom. Make sure to replace `<axiom-api-token-here>` and `<axiom-dataset-name-here>` with your actual Axiom API key and dataset name.


**5: Run your function**

Now you can run your function and see the telemetry data in Axiom. You can use the AWS console to test your function and see the logs in Axiom. If everything is setup correctly you should see the traces in the Axiom UI.